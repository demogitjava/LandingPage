<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="de">
<head>
  <meta charset="UTF-8">
  <!--
  <title th:text="@{page-title}"></title> -->
  <title>Demo WebSiteBuilder</title>

  <link th:href="@{/bootstrap4/css/bootstrap.css}" rel="stylesheet" />
  <link th:href="@{/grapesjs/css/grapes.min.css}" rel="stylesheet" />
  <link th:href="@{/css/small-business.css}" rel="stylesheet" />

  <!--
  https://fontawesome.com
  -->
  <link th:href="@{/fontawesome/css/fontawesome.css}" rel="stylesheet" />
  <link th:href="@{/grapesjs/css/grapesjs-preset-webpage.min.css}" rel="stylesheet" />

  <script th:src="@{/jquery/jquery-3.5.1.min.js}"></script>
  <script th:src="@{/bootstrap4/js/bootstrap.js}"></script>
  <script th:src="@{/popper.min.js}"></script>

  <script th:src="@{/grapesjs/grapes.min.js}"></script>
  <script th:src="@{/grapesjs/grapesjs-preset-webpage-extend.min.js}"></script>
  <script th:src="@{/webpagepresent/grapesjs-blocks-bootstrap4.min.js}"></script>
  <script th:src="@{/grapesjs/ajaxable.min.js}"></script>

  <!--
        implement start-bootstrap
        startbootstrap.small-business lib starter template
  -->
  <link th:href="@{/vendor/bootstrap/css/bootstrap.css}" rel="stylesheet" />
  <link th:href="@{/vendor/bootstrap/css/bootstrap-grid.css}" rel="stylesheet" />
  <link th:href="@{/vendor/bootstrap/css/bootstrap-reboot.css}" rel="stylesheet" />

  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.js}"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.js}"></script>
  <script th:src="@{/grapesjs/bootstrap.bundle.min.js}"></script>
  <!--
  <script th:src="@{/vendor/jquery/jquery.js}"></script>
  -->

  <style>

    body,
    html
    {

      padding: 0;
      margin: 0;
      height: 100%;

    }
  </style>

</head>

<body>


<div class="container-fluid">



  <ul class="breadcrumb">
    <li><a href="#">Home</a> <span class="divider">/</span></li>
    <li class="active">Editor</li>
  </ul>







  <div class="row">

    <div class="col-md-2">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
          save Template Data to file
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <li><a class="dropdown-item" onclick="gethtmldata()">Header</a></li>
          <li><a class="dropdown-item" onclick="gethtmlcontentdata()">Content Body</a></li>
          <li><a class="dropdown-item" onclick="gethtmlfooterdata()">Footer</a></li>
        </ul>
      </div>

      <div id="messageinfo">
      </div>




      <script type="text/javascript">


        /**  HEADER
         *  post data to Rest Controller
         *  to save as file
         *  and store in database

         *
         */
        function gethtmldata()
        {
          var htmldata = localStorage.getItem("gjs-html");
          var cssdata = localStorage.getItem("gjs-css");


          $.ajax({
            type : "POST",
            url : "saveheaderdata",
            data : {
              gjshtml : localStorage.getItem('gjs-html'),
              gjscss : localStorage.getItem('gjs-css')
            }, // parameters
            success : function(result) {
              // alert('changed');
              console.log('sucess');
              $( "#messageinfo" ).html( "<strong>" + result + "</strong>" );
            }
          });

        }


        /**
         * CONTENT
         * post data to RestController
         * to save Content as file
         */
        function gethtmlcontentdata()
        {
          var htmldata = localStorage.getItem("gjs-html");
          var cssdata = localStorage.getItem("gjs-css");

          $.ajax({
            type : "POST",
            url : "savecontentdata",
            data : {
              gjshtml : localStorage.getItem('gjs-html'),
              gjscss : localStorage.getItem('gjs-css')
            }, // parameters
            success : function(result) {
              // alert('changed');
              console.log('sucess');
              $( "#messageinfo" ).html( "<strong>" + result + "</strong>" );
            }
          });

        }


        /**
         *  FOOTER
         *  post data to RestCotroller
         *  to save footer as file
         */
        function gethtmlfooterdata()
        {
          var htmldata = localStorage.getItem("gjs-html");
          var cssdata = localStorage.getItem("gjs-css");

          $.ajax({
            type : "POST",
            url : "savefooterdata",
            data : {
              gjshtml : localStorage.getItem('gjs-html'),
              gjscss : localStorage.getItem('gjs-css')
            }, // parameters
            success : function(result) {
              // alert('changed');
              console.log('sucess');
              $( "#messageinfo" ).html( "<strong>" + result + "</strong>" );
            }
          });

        }


      </script>

    </div>

    <div class="col-md-10">
      <div id="gjs" th:include="demo.html"></div>
      <script type="text/javascript">

        var editor = grapesjs.init
        ({
          height: '100%',
          fromElement: 1,
          clearOnRender: true,
          container: '#gjs',
          plugins: ['gjs-preset-webpage', 'grapesjs-blocks-bootstrap4'],
          pluginsOpts: {
            'gjs-preset-webpage': {
              callSaveOpts: {
                call: (data) => {
                  console.log("data", data);
                },
              }
            },
          }

        });


        editor.BlockManager.add('Container',
                {
                  category: 'Bootstrap4 Thymeleaf',
                  label: '<h1><i class="fa fa-th fa-lg"></i></h1>Container',
                  content: '<div class="container-fluid">' +
                          '<div class="row">' +
                          '<div class="col-sm-6"><p>row1</p></div>' +
                          '<div class="col-sm-6"><p>row2</p></div>' +
                          '<div class="col-sm-6"><p>row1</p></div>' +
                          '<div class="col-sm-6"><p>row2</p></div>' +
                          '<div class="col-sm-6"><p>row1</p></div>' +
                          '<div class="col-sm-6"><p>row2</p></div>' +
                          '<div class="col-sm-6"><p>row1</p></div>' +
                          '<div class="col-sm-6"><p>row2</p></div>' +
                          '</div>' +
                          '</div>'
                });

        editor.BlockManager.add('add_Row - 12',
                {
                  category: 'Bootstrap4 Thymeleaf',
                  label: '<h1><i class="fa fa-th fa-lg"></i></h1>Row - 12  5/5',
                  content: '<div class="row">' +
                          '<div class="col-sm-6"><p>row1</p></div>' +
                          '<div class="col-sm-6"><p>row2</p></div>' +
                          '</div>',
                });

        editor.BlockManager.add('TestMessage',
                {
                  category: 'Bootstrap4 Thymeleaf',
                  label: '<h1><i class="fa fa-th fa-lg"></i></h1> dynamic test',
                  content: '<p>${message}</p>',

                });

        editor.getConfig().showDevices = false;
        window.editor = editor;
      </script>
      <div id="tablecrud">
          <table class="table table-striped">
          <thead>
          <tr>
            <th>id</th>
            <th>Framename</th>
            <th>German</th>
            <th>English</th>
            <th>French</th>
            <th>Spanish</th>
            <th>Italian</th>
            <th>Turkish</th>
            <th>bindto</th>
            <th>Template</th>
            <th>Title Template</th>
            <th>Edit</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="webtextlayout : ${listtemplate}">
            <td th:text="${webtextlayout.id}">id</td>
            <td th:text="${webtextlayout.framename}">Framename</td>
            <td th:text="${webtextlayout.de}">German</td>
            <td th:text="${webtextlayout.en}">English</td>
            <td th:text="${webtextlayout.fr}">French</td>
            <td th:text="${webtextlayout.es}">Spanish</td>
            <td th:text="${webtextlayout.it}">Italian</td>
            <td th:text="${webtextlayout.tr}">Turkish</td>
            <td th:text="${webtextlayout.bindto}">bindto</td>
            <td th:text="${webtextlayout.template}">Template</td>
            <td th:text="${webtextlayout.titletemplate}">Title Template</td>
            <td>
              <!-- Button trigger modal -->
              <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#exampleModal" th:attrappend="data-target=${webtextlayout.id}">
                Edit
              </button>

              <!-- Modal -->
              <div class="modal fade" id="exampleModal" role="dialog" th:attrappend="id=${webtextlayout.id}" >
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="headertitle">Modal title</h5>

                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <!--
                             <form action="#" th:action="@{/students/update/{id}(id=${student.id})}" th:object="${student}" method="post">
                      -->
                      <form action="#" th:action="@{/edit/crudlist}" method="post">

                        <div class="form-group col-md-12">

                          <label class="label label-default">ID
                            <input type="text"  th:value="${webtextlayout.id}" class="form-control" id="id" name="id" placeholder="id"/>
                          </label>

                          <label class="label label-default">Framename
                            <input type="text"  th:value="${webtextlayout.framename}" class="form-control" id="framename" name="framename" placeholder="Framename"/>
                          </label>

                          <label class="label label-default">de
                            <input type="text" th:value="${webtextlayout.de}" class="form-control" id="de" placeholder="de" name="de"/>
                          </label>

                          <label class="label label-default">en
                            <input type="text" th:value="${webtextlayout.en}" class="form-control" id="en" placeholder="en" name="en"/>
                          </label>

                          <label class="label label-default">fr
                            <input type="text" th:value="${webtextlayout.fr}" class="form-control" id="fr" placeholder="fr" name="fr"/>
                          </label>

                          <label class="label label-default">ESP
                            <input type="text" th:value="${webtextlayout.es}" class="form-control" id="es" placeholder="esp" name="es"/>
                          </label>

                          <label class="label label-default">it
                            <input type="text" th:value="${webtextlayout.it}" class="form-control" id="it" placeholder="it" name="it"/>
                          </label>

                          <label class="label label-default">tr
                            <input type="text" th:value="${webtextlayout.tr}" class="form-control" id="tr" placeholder="tr" name="tr"/>
                          </label>

                          <label class="label label-default">bindto
                            <input type="text" th:value="${webtextlayout.bindto}" class="form-control" id="bindto" placeholder="Framename" name="bindto"/>
                          </label>

                          <label class="label label-default">comp_name
                            <input type="text" th:value="${webtextlayout.comp_name}" class="form-control" id="comp_name" placeholder="Framename" name="comp_name"/>
                          </label>


                        </div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-secondary">Save changes</button>
                      </form>

                    </div>
                    <div class="modal-footer">

                    </div>
                  </div>
                </div>
              </div>

            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>

</div>

</body>
</html>
